<html>

<head>
    <title>Orbit IM</title>
    <style>
        * {
            font-family: 'Rubik', sans-serif;
        }
        
        .send-module {
            position: fixed;
            bottom: 0px;
            padding-top: 25px;
            padding-bottom: 25px;
            left: 0px;
            width: 100%;
            border-radius: 20px 20px 0px 0px;
            background-image: linear-gradient(to right, #31a6ff, #31c7ff);
            text-align: center;
        }
        
        .centred {
            margin: auto;
            width: 50%;
            font-size: 40px;
            text-align: center;
        }
        
        .okButton {
            border: none;
            border-radius: 5px;
            background-color: #31A6FF;
            padding: 10px 35px;
            font-size: 25px;
        }
        
        .member-pane {
            width: 15%;
            height: 100%;
            background-color: #E5E7E9;
            position: fixed;
            right: 0px;
            top: 0px;
            text-align: center;
        }
        
        #messageContent {
            border-radius: 5px;
            width: 430px;
            padding: 10px 5px;
            padding: 10px;
            border: none;
            outline: none;
            display: inline-block;
        }
        
        .button {
            position: relative;
            top: 2px;
            display: inline-block;
            color: white;
            background: none;
            border: none;
            border-radius: 100%;
            width: 35px;
            height: 35px;
            font-size: 20px;
            outline: none;
            transition-duration: 300ms;
        }
        
        .button:hover {
            color: #31A6FF;
            background-color: white;
            cursor: pointer;
        }
        
        #Username {
            border-radius: 5px;
            width: 250px;
            padding: 10px 5px;
            border: solid 2px #31A6ff;
            outline: none;
        }
        
        .username {
            font-weight: bold;
        }
        
        .time {
            color: darkgray;
            font-size: 10px;
        }
    </style>
    <link rel="shortcut icon" type="image/png" href="icon.png">
    <script src="http://code.jquery.com/jquery-1.8.2.min.js"></script>
</head>

<body>
    <div>
        <div>
            <h1>Orbit Messenger</h1>
            <div>
                <label><input id="Username" placeholder="Username" value="user"></input> has joined the channel</label>
            </div>
        </div>
        <div class="member-pane">
            <h1>Members</h1>
            <ul class="memberList" id="memberList">
            </ul>
        </div>
        <div class="display-content">
            <div>
                <ul id="messageList">
                </ul>
            </div>
        </div>
        <div class="send-module">
            <form action="">
                <input id="messageContent"></input>

                <label for="messageContent">
                  <button type="button" name="button" class="button" id="sendMessageButton"><i class="fas fa-paper-plane"></i></button>
                </label>
                <label>
                  <button id="reset" class="button"><i class="fas fa-redo"></i></button>
                </label>
            </form>
        </div>
    </div>
    <script src="/socket.io/socket.io.js"></script>
    <script>
        $("#Username").val(localStorage.val);

        $(function() {
            var socket = io();

            //Send
            socket.emit('user connect', $('#Username').val());

            $('form').submit(function() {
                var time = new Date();
                var message = {
                    "text": $('#messageContent').val(),
                    "username": $('#Username').val(),
                    "time": time.getHours() + ":" + time.getSeconds() + ":" + time.getMinutes()
                }
                message = JSON.stringify(message);

                socket.emit('chat message', message);
                $('#messageContent').val('');
                return false;
            });


            //Recieve
            //Chat Message
            socket.on('chat message', function(msg) {
                message = JSON.parse(msg);
                console.log(msg);
                var messageEl = $("<li class='message " + "'>" +
                    "<span class='username'>" + message.username + " </span>" +
                    "<span class='time'>" + message.time + "</span><br/>" +
                    message.text +
                    "</li>");

                $('#messageList').append(messageEl);
                window.scrollTo(0, document.body.scrollHeight);
            });

            //User Connect
            socket.on('user connect', function(name) {
                console.log("name")
                $("#memberList").append($("<li>").text(name));
            })
        });
    </script>
</body>

</html>